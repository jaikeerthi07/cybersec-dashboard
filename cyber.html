<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberSec Pro - Secure Code Review Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 100%);
            color: #ffffff;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1.2rem;
            color: #a0a0a0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .stat-card.critical {
            border-left: 4px solid #ff4757;
        }

        .stat-card.medium {
            border-left: 4px solid #ffa502;
        }

        .stat-card.low {
            border-left: 4px solid #2ed573;
        }

        .stat-card.info {
            border-left: 4px solid #3742fa;
        }

        .stat-number {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1.1rem;
            color: #a0a0a0;
        }

        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .vulnerabilities-panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }

        .panel-header {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px 30px;
            font-size: 1.4rem;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .filter-tabs {
            display: flex;
            gap: 10px;
        }

        .tab {
            padding: 8px 16px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .tab.active {
            background: #4ecdc4;
            transform: scale(1.05);
        }

        .vulnerabilities-list {
            max-height: 600px;
            overflow-y: auto;
            padding: 0;
        }

        .vulnerability-item {
            padding: 20px 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: background 0.3s ease;
            cursor: pointer;
        }

        .vulnerability-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .vuln-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 10px;
        }

        .severity-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-right: 15px;
        }

        .severity-critical {
            background: #ff4757;
            color: white;
        }

        .severity-medium {
            background: #ffa502;
            color: white;
        }

        .severity-low {
            background: #2ed573;
            color: white;
        }

        .vuln-title {
            font-size: 1.1rem;
            font-weight: bold;
            flex-grow: 1;
        }

        .vuln-file {
            color: #4ecdc4;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .vuln-description {
            color: #a0a0a0;
            line-height: 1.4;
        }

        .side-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .recommendations-panel, .tools-panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 25px;
        }

        .recommendation-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 3px solid #4ecdc4;
        }

        .tool-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            margin-bottom: 10px;
            transition: transform 0.2s ease;
        }

        .tool-item:hover {
            transform: translateX(5px);
            background: rgba(255, 255, 255, 0.1);
        }

        .tool-status {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 15px;
        }

        .status-active {
            background: #2ed573;
            box-shadow: 0 0 10px rgba(46, 213, 115, 0.5);
        }

        .status-inactive {
            background: #ff4757;
            box-shadow: 0 0 10px rgba(255, 71, 87, 0.5);
        }

        .code-viewer {
            background: #1a1a2e;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
        }

        .code-viewer.active {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .code-tabs {
            display: flex;
            gap: 10px;
        }

        .code-tab {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .code-tab.active {
            background: #ff4757;
        }

        .code-content {
            background: #0f0f0f;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .code-vulnerable {
            color: #ff6b6b;
        }

        .code-secure {
            color: #51cf66;
        }

        .timeline {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 20px;
        }

        .timeline-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .timeline-item:last-child {
            border-bottom: none;
        }

        .priority-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-right: 20px;
            flex-shrink: 0;
        }

        .priority-p0 { background: #ff4757; box-shadow: 0 0 10px rgba(255, 71, 87, 0.5); }
        .priority-p1 { background: #ffa502; box-shadow: 0 0 10px rgba(255, 165, 2, 0.5); }
        .priority-p2 { background: #2ed573; box-shadow: 0 0 10px rgba(46, 213, 115, 0.5); }

        .timeline-content {
            flex-grow: 1;
        }

        .timeline-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .timeline-meta {
            color: #a0a0a0;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .container {
                padding: 15px;
            }
        }

        .export-btn {
            background: linear-gradient(45deg, #4ecdc4, #45b7d1);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(78, 205, 196, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🛡️ CyberSec Pro Dashboard</h1>
            <p>Comprehensive Security Code Review | Node.js Application Audit</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card critical">
                <div class="stat-number" id="criticalCount">3</div>
                <div class="stat-label">Critical Issues</div>
            </div>
            <div class="stat-card medium">
                <div class="stat-number" id="mediumCount">12</div>
                <div class="stat-label">Medium Risk</div>
            </div>
            <div class="stat-card low">
                <div class="stat-number" id="lowCount">8</div>
                <div class="stat-label">Low Risk</div>
            </div>
            <div class="stat-card info">
                <div class="stat-number" id="scanProgress">98%</div>
                <div class="stat-label">Scan Complete</div>
            </div>
        </div>

        <div class="main-content">
            <div class="vulnerabilities-panel">
                <div class="panel-header">
                    <span>🔍 Vulnerabilities Detected</span>
                    <div class="filter-tabs">
                        <button class="tab active" data-filter="all">All</button>
                        <button class="tab" data-filter="critical">Critical</button>
                        <button class="tab" data-filter="medium">Medium</button>
                        <button class="tab" data-filter="low">Low</button>
                    </div>
                </div>
                <div class="vulnerabilities-list" id="vulnList">
                    <!-- Vulnerabilities will be populated by JavaScript -->
                </div>
            </div>

            <div class="side-panel">
                <div class="recommendations-panel">
                    <div class="panel-header">
                        <span>💡 Quick Fixes</span>
                    </div>
                    <div class="recommendation-item">
                        <strong>Implement Input Validation</strong><br>
                        Use Joi or similar library for all user inputs
                    </div>
                    <div class="recommendation-item">
                        <strong>Enable Security Headers</strong><br>
                        Deploy Helmet.js middleware immediately
                    </div>
                    <div class="recommendation-item">
                        <strong>Update Dependencies</strong><br>
                        12 packages have security patches available
                    </div>
                </div>

                <div class="tools-panel">
                    <div class="panel-header">
                        <span>🔧 Security Tools Status</span>
                    </div>
                    <div class="tool-item">
                        <div class="tool-status status-active"></div>
                        <span>ESLint Security Plugin</span>
                    </div>
                    <div class="tool-item">
                        <div class="tool-status status-active"></div>
                        <span>Snyk Vulnerability Scanner</span>
                    </div>
                    <div class="tool-item">
                        <div class="tool-status status-inactive"></div>
                        <span>OWASP ZAP</span>
                    </div>
                    <div class="tool-item">
                        <div class="tool-status status-active"></div>
                        <span>SonarQube Security</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="code-viewer" id="codeViewer">
            <div class="code-header">
                <h3>Code Analysis</h3>
                <div class="code-tabs">
                    <button class="code-tab active" data-code="vulnerable">Vulnerable</button>
                    <button class="code-tab" data-code="secure">Fixed</button>
                </div>
            </div>
            <div class="code-content" id="codeContent">
                <!-- Code will be populated by JavaScript -->
            </div>
        </div>

        <div class="timeline">
            <div class="panel-header">
                <span>⏱️ Remediation Timeline</span>
            </div>
            <div class="timeline-item">
                <div class="priority-dot priority-p0"></div>
                <div class="timeline-content">
                    <div class="timeline-title">Fix Command Injection</div>
                    <div class="timeline-meta">Priority: P0 | Deadline: 24 hours | Effort: 4h</div>
                </div>
            </div>
            <div class="timeline-item">
                <div class="priority-dot priority-p0"></div>
                <div class="timeline-content">
                    <div class="timeline-title">Secure JWT Authentication</div>
                    <div class="timeline-meta">Priority: P0 | Deadline: 24 hours | Effort: 6h</div>
                </div>
            </div>
            <div class="timeline-item">
                <div class="priority-dot priority-p0"></div>
                <div class="timeline-content">
                    <div class="timeline-title">Prevent NoSQL Injection</div>
                    <div class="timeline-meta">Priority: P0 | Deadline: 48 hours | Effort: 8h</div>
                </div>
            </div>
            <div class="timeline-item">
                <div class="priority-dot priority-p1"></div>
                <div class="timeline-content">
                    <div class="timeline-title">Implement XSS Protection</div>
                    <div class="timeline-meta">Priority: P1 | Deadline: 3 days | Effort: 12h</div>
                </div>
            </div>
            <div class="timeline-item">
                <div class="priority-dot priority-p2"></div>
                <div class="timeline-content">
                    <div class="timeline-title">Add Security Headers</div>
                    <div class="timeline-meta">Priority: P2 | Deadline: 1 week | Effort: 2h</div>
                </div>
            </div>
        </div>

        <button class="export-btn" onclick="exportReport()">📊 Export Security Report</button>
    </div>

    <script>
        const vulnerabilities = [
            {
                id: 1,
                title: "Command Injection in File Processor",
                severity: "critical",
                file: "utils/fileProcessor.js:78-82",
                description: "Unsanitized user input passed to exec() allows arbitrary command execution",
                cwe: "CWE-78",
                vulnerable: `// VULNERABLE - Direct command execution
const command = \`convert \${req.body.filename} output.pdf\`;
exec(command, (error, stdout, stderr) => {
    // Process results
});`,
                secure: `// SECURE - Input validation and parameterized execution
const filename = path.basename(req.body.filename);
if (!/^[a-zA-Z0-9._-]+$/.test(filename)) {
    throw new Error('Invalid filename');
}
const args = [filename, 'output.pdf'];
execFile('convert', args, (error, stdout, stderr) => {
    // Process results safely
});`
            },
            {
                id: 2,
                title: "Authentication Bypass via JWT",
                severity: "critical",
                file: "middleware/auth.js:15-25",
                description: "JWT tokens verified without signature validation, allowing token forgery",
                cwe: "CWE-287",
                vulnerable: `// VULNERABLE - No signature verification
if (token && token !== 'null') {
    const decoded = jwt.decode(token);
    req.user = decoded;
    next();
}`,
                secure: `// SECURE - Proper JWT verification
try {
    const decoded = jwt.verify(token, process.env.JWT_SECRET, {
        algorithms: ['HS256'],
        expiresIn: '1h'
    });
    req.user = decoded;
    next();
} catch (error) {
    return res.status(401).json({ error: 'Invalid token' });
}`
            },
            {
                id: 3,
                title: "NoSQL Injection Vulnerability",
                severity: "critical",
                file: "controllers/userController.js:45-52",
                description: "User-controlled input directly embedded in MongoDB query",
                cwe: "CWE-89",
                vulnerable: `// VULNERABLE - Direct query injection
const user = await User.findOne({
    email: req.body.email,
    $where: req.body.condition
});`,
                secure: `// SECURE - Input validation and sanitization
const { email } = req.body;
if (!validator.isEmail(email)) {
    return res.status(400).json({ error: 'Invalid email' });
}
const user = await User.findOne({ email: { $eq: email } });`
            },
            {
                id: 4,
                title: "Cross-Site Scripting (XSS)",
                severity: "medium",
                file: "routes/dashboard.js:120",
                description: "User input rendered without proper encoding",
                cwe: "CWE-79",
                vulnerable: `// VULNERABLE - Direct HTML rendering
res.send(\`<h1>Welcome \${req.body.username}</h1>\`);`,
                secure: `// SECURE - HTML encoding
const escapeHtml = require('escape-html');
res.send(\`<h1>Welcome \${escapeHtml(req.body.username)}</h1>\`);`
            },
            {
                id: 5,
                title: "Insecure Direct Object Reference",
                severity: "medium",
                file: "controllers/documentController.js:67",
                description: "Missing authorization check for document access",
                cwe: "CWE-639",
                vulnerable: `// VULNERABLE - No authorization
const doc = await Document.findById(req.params.id);
res.json(doc);`,
                secure: `// SECURE - Authorization check
const doc = await Document.findOne({
    _id: req.params.id,
    userId: req.user.id
});
if (!doc) return res.status(404).json({ error: 'Not found' });
res.json(doc);`
            }
        ];

        let currentFilter = 'all';
        let selectedVuln = null;

        function initDashboard() {
            renderVulnerabilities();
            setupEventListeners();
            animateCounters();
        }

        function renderVulnerabilities() {
            const vulnList = document.getElementById('vulnList');
            const filtered = currentFilter === 'all' 
                ? vulnerabilities 
                : vulnerabilities.filter(v => v.severity === currentFilter);

            vulnList.innerHTML = filtered.map(vuln => `
                <div class="vulnerability-item" onclick="showVulnerability(${vuln.id})">
                    <div class="vuln-header">
                        <span class="severity-badge severity-${vuln.severity}">${vuln.severity.toUpperCase()}</span>
                        <div class="vuln-title">${vuln.title}</div>
                    </div>
                    <div class="vuln-file">📁 ${vuln.file}</div>
                    <div class="vuln-description">${vuln.description}</div>
                </div>
            `).join('');
        }

        function setupEventListeners() {
            // Filter tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    e.target.classList.add('active');
                    currentFilter = e.target.dataset.filter;
                    renderVulnerabilities();
                });
            });

            // Code tabs
            document.querySelectorAll('.code-tab').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    document.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
                    e.target.classList.add('active');
                    if (selectedVuln) {
                        showCode(selectedVuln, e.target.dataset.code);
                    }
                });
            });
        }

        function showVulnerability(id) {
            selectedVuln = vulnerabilities.find(v => v.id === id);
            const codeViewer = document.getElementById('codeViewer');
            codeViewer.classList.add('active');
            
            const activeTab = document.querySelector('.code-tab.active').dataset.code;
            showCode(selectedVuln, activeTab);
            
            // Scroll to code viewer
            codeViewer.scrollIntoView({ behavior: 'smooth' });
        }

        function showCode(vuln, type) {
            const codeContent = document.getElementById('codeContent');
            const code = type === 'vulnerable' ? vuln.vulnerable : vuln.secure;
            const className = type === 'vulnerable' ? 'code-vulnerable' : 'code-secure';
            
            codeContent.innerHTML = `<pre class="${className}">${escapeHtml(code)}</pre>`;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function animateCounters() {
            const counters = [
                { id: 'criticalCount', target: 3, duration: 1000 },
                { id: 'mediumCount', target: 12, duration: 1500 },
                { id: 'lowCount', target: 8, duration: 1200 }
            ];

            counters.forEach(counter => {
                const element = document.getElementById(counter.id);
                let current = 0;
                const increment = counter.target / (counter.duration / 50);
                
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= counter.target) {
                        element.textContent = counter.target;
                        clearInterval(timer);
                    } else {
                        element.textContent = Math.floor(current);
                    }
                }, 50);
            });

            // Animate progress
            let progress = 0;
            const progressTimer = setInterval(() => {
                progress += 2;
                document.getElementById('scanProgress').textContent = progress + '%';
                if (progress >= 98) {
                    clearInterval(progressTimer);
                }
            }, 30);
        }

        function exportReport() {
            const reportData = {
                timestamp: new Date().toISOString(),
                summary: {
                    critical: 3,
                    medium: 12,
                    low: 8,
                    total: 23
                },
                vulnerabilities: vulnerabilities
            };

            const blob = new Blob([JSON.stringify(reportData, null, 2)], 
                { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `security-report-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            // Show success message
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '✅ Report Exported!';
            btn.style.background = '#2ed573';
            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.background = 'linear-gradient(45deg, #4ecdc4, #45b7d1)';
            }, 2000);
        }

        // Initialize dashboard when page loads
        document.addEventListener('DOMContentLoaded', initDashboard);

        // Add some dynamic behavior
        setInterval(() => {
            const tools = document.querySelectorAll('.tool-status');
            tools.forEach(tool => {
                if (Math.random() > 0.95) { // Occasionally flicker
                    tool.style.opacity = '0.5';
                    setTimeout(() => {
                        tool.style.opacity = '1';
                    }, 200);
                }
            });
        }, 5000);
    </script>
</body>
</html>